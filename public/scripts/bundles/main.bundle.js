!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){var n={up:!1,down:!1,left:!1,right:!1};document.addEventListener("keydown",(function(t){switch(t.keyCode){case 65:e.exports.updateMovement("left",!0);break;case 87:e.exports.updateMovement("up",!0);break;case 68:e.exports.updateMovement("right",!0);break;case 83:e.exports.updateMovement("down",!0)}})),document.addEventListener("keyup",(function(t){switch(t.keyCode){case 65:e.exports.updateMovement("left",!1);break;case 87:e.exports.updateMovement("up",!1);break;case 68:e.exports.updateMovement("right",!1);break;case 83:e.exports.updateMovement("down",!1)}})),e.exports.updateMovement=function(e,t){n[e]=t},e.exports.getMovement=function(){return n}},function(e,t,n){(function(e){e.socket=io();n(3);var t=n(1);n(4);setInterval((function(){socket.emit("playerMovement",t.getMovement())}),1e3/60)}).call(this,n(0))},function(e,t){var n=document.getElementById("chat-text"),a=document.getElementById("chat-input"),o=document.getElementById("chat-form"),r=!1;o.onsubmit=function(e){e.preventDefault(),socket.emit("sendMsgToServer",a.value),a.value=""},socket.on("addToChat",(function(e){console.log("CLIENT: Received chat message."),n.innerHTML+='<div class="chatCell">'+e+"</div>",n.scrollTop=n.scrollHeight})),document.addEventListener("DOMContentLoaded",(function(){document.getElementById("chat-input").addEventListener("focus",(function(){r=!0})),document.getElementById("chat-input").addEventListener("blur",(function(){r=!1}))})),document.onkeyup=function(e){13===e.keyCode&&(r?a.blur():a.focus())}},function(e,t,n){var a=document.getElementById("mapContainer").getContext("2d"),o=document.getElementById("playerContainer").getContext("2d"),r=(document.getElementById("uiContainer").getContext("2d"),n(5)),i=n(6);r.map.context=a,r.map.loadMap("map1"),socket.on("playersState",(function(e){i.updatePlayersState(o,e)}))},function(e,t){e.exports.map={context:null,mapData:null,mapTileSet:null,mapLayers:[],renderMapLayer:function(e){if("tilelayer"===e.type&&e.opacity){var t=this.context.canvas.cloneNode();t=t.getContext("2d");var n=this.mapData.height,a=this.mapData.width,o=this.mapData.tilewidth;if(this.mapLayers.length<this.mapData.layers.length){for(var r=0;r<a;r++)for(var c=0;c<n;c++){var s=e.data[c*a+r];0!==s&&(s--,img_x=s%(this.mapData.tilesets[0].imagewidth/o)*o,img_y=~~(s/(this.mapData.tilesets[0].imagewidth/o))*o,t.drawImage(this.mapTileSet,img_x,img_y,o,o,r*o,c*o,o,o))}this.mapLayers.push(t.canvas.toDataURL()),this.context.drawImage(t.canvas,0,0)}else for(i=0;i<=this.mapLayers.length;i++){var u=$("<img />",{src:this.mapLayers[i]})[0];this.context.drawImage(u,0,0)}}},renderMapLayers:function(t){t=$.isArray(t)?t:this.mapData.layers,$.each(t,(function(t,n){e.exports.map.renderMapLayer($(this)[0])}))},loadMapTileset:function(t){this.mapData=t,this.mapTileSet=new Image,this.mapTileSet.src="/public/maps/tilesets/"+t.tilesets[0].image,this.mapTileSet.onload=function(){e.exports.map.renderMapLayers(e.exports.map)}},loadMap:function(t){$.getJSON("/public/maps/"+t+".json",(function(t){e.exports.map.loadMapTileset(t)}))}}},function(e,t,n){var a=n(7);n(1);a.loadSpriteSheet(),e.exports.updatePlayersState=function(e,t){for(var n in e.clearRect(0,0,800,608),e.fillStyle="green",t){var o=t[n];e.beginPath(),a.drawPlayer(e,o)}}},function(e,t){var n,a,o,r=0,i=0,c=0;e.exports.loadSpriteSheet=function(){n||((n=new Image).onload=function(){a=n.width/3,o=n.height/4},n.src="./public/images/characters/male-01-1.png")},e.exports.drawPlayer=function(t,r){e.exports.updateSpriteFrame(t,r),t.drawImage(n,i,c,a,o,r.x-a/2,r.y-o/2,a,o)},e.exports.updateSpriteFrame=function(e,t){r=t.movement.left||t.movement.right||t.movement.up||t.movement.down?++r%3:0,i=r*a,t.movement.up&&(c=3*o),t.movement.down&&(c=0*o),t.movement.left&&(c=1*o),t.movement.right&&(c=2*o),e.clearRect(t.x,t.y,a,o)}}]);